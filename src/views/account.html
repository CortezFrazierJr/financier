<div class="account" st-table="displayedTransactions" st-safe-src="transactions" disable-ng-animate>
  <div class="account__tbody">
    <div class="account__tr account__tr--overview">
      <div class="account__name" ng-click="dbCtrl.editAccount(accountCtrl.account)">{{accountCtrl.account.name}}</div>
      <div class="account__balance">
        <div>
          <div class="account__balance-title">{{'CLEARED_BALANCE' | translate}}</div>
          <div class="account__balance-value" ng-class="{'account__balance-value--negative': accountCtrl.account.cache.clearedBalance < 0}">{{accountCtrl.account.cache.clearedBalance | intCurrency | currency}}</div>
        </div>
      </div>
      <div class="account__operator">+</div>
      <div class="account__balance">
        <div>
          <div class="account__balance-title">{{'UNCLEARED_BALANCE' | translate}}</div>
          <div class="account__balance-value" ng-class="{'account__balance-value--negative': accountCtrl.account.cache.unclearedBalance < 0}">{{accountCtrl.account.cache.unclearedBalance | intCurrency | currency}}</div>
        </div>
      </div>
      <div class="account__operator">=</div>
      <div class="account__balance">
        <div>
          <div class="account__balance-title">{{'WORKING_BALANCE' | translate}}</div>
          <div class="account__balance-value" ng-class="{'account__balance-value--negative': accountCtrl.account.cache.balance < 0}">{{accountCtrl.account.cache.balance | intCurrency | currency}}</div>
        </div>
      </div>
    </div>
  </div>
  <div class="account__tbody">
    <div class="account__tr">
      <button class="account__add-button" ng-click="accountCtrl.createTransaction()"><i class="fa fa-plus"></i> {{'ADD_A_NEW_TRANSACTION' | translate}}</button>
      <button class="account__add-button"><i class="fa fa-exchange"></i> Make a transfer</button>

      <button class="account__add-button" ng-if="accountCtrl.selectedTransactions.length" bulk-edit-transactions="accountCtrl.selectedTransactions" manager="dbCtrl.manager"><i class="fa fa-edit"></i> Edit ({{accountCtrl.selectedTransactions.length}}) <i class="fa fa-sort-desc"></i></button>
    </div>
  </div>
  <div class="account__thead" ng-click="dbCtrl.stopPropagation($event)">
    <div class="account__tr">
      <div class="account__th account__th--select">
        <input type="checkbox" ng-model="accountCtrl.isAllSelected" ng-model-options="{ getterSetter: true }">
      </div>
      <div class="account__th" ng-if="!accountCtrl.accountId" st-sort="accountCtrl.customSorts.account"><span>{{'ACCOUNT' | translate}}</span></div>
      <div class="account__th account__th--flag" st-sort="flag"><div class="account__header-flag"><div></div></div></div>
      <div class="account__th account__th--date" st-sort="accountCtrl.customSorts.date" st-sort-default="reverse"><span>{{'DATE' | translate}}</span></div>
      <div class="account__th" st-sort="payee"><span>{{'PAYEE' | translate}}</span></div>
      <div class="account__th" st-sort="category"><span>{{'CATEGORY' | translate}}</span></div>
      <div class="account__th account__cell-memo"><span>{{'MEMO' | translate}}</span></div>
      <div class="account__th account__cell-inflow" st-sort="inflow"><span>{{'INFLOW' | translate}}</span></div>
      <div class="account__th account__cell-outflow" st-sort="outflow"><span>{{'OUTFLOW' | translate}}</span></div>
      <div class="account__th account__cell-cleared" st-sort="cleared"><span>{{'CLEARED' | translate}}</span></div>
    </div>
  </div>

  <div class="account__tbody">
    <div ng-if="accountCtrl.newTransaction"
         class="account__tr account__tr--editing"
         hotkey="{esc: accountCtrl.cancelCreateTransaction, enter: accountCtrl.createTransaction}"
         ng-click="dbCtrl.stopPropagation($event)">
      <div class="account__td account__td--select"></div>
      <div class="account__td" ng-if="!accountCtrl.accountId">
        <account-suggest ng-model="accountCtrl.newTransaction.account" transaction-payee-id="accountCtrl.newTransaction.payee.id" accounts="accountCtrl.manager.accounts"></account-suggest>
      </div>
      <div class="account__td account__td--flag"><div class="account__flag" ng-style="{'color': accountCtrl.newTransaction.flag}" flag ng-model="accountCtrl.newTransaction.flag"><div></div></div></div>
      <div class="account__td account__td--date">
        <calendar-input ng-model="accountCtrl.newTransaction.date"></calendar-input>
      </div>
      <div class="account__td">
        <payee-suggest ng-model="accountCtrl.newTransaction.payee" transaction-account-id="accountCtrl.newTransaction.account" accounts="dbCtrl.accounts" payees="accountCtrl.manager.payees"></payee-suggest>
      </div>
      <div class="account__td">
        <category-suggest ng-model="accountCtrl.newTransaction.category" categories="dbCtrl.categories" master-categories="dbCtrl.masterCategories" transaction-date="accountCtrl.newTransaction.date"></category-suggest>
      </div>
      <div class="account__td account__cell-memo">
        <memo-input ng-model="accountCtrl.newTransaction.memo"></memo-input>
      </div>
      <div class="account__td account__cell-inflow">
        <input type="text" transaction-value ng-model="accountCtrl.newTransaction.inflow">
      </div>
      <div class="account__td account__cell-outflow">
        <input type="text" transaction-value ng-model="accountCtrl.newTransaction.outflow">
      </div>
      <div class="account__td account__cell-cleared">
        <div class="cleared" ng-class="{'cleared--true': accountCtrl.newTransaction.cleared}" ng-click="accountCtrl.setCleared($event, accountCtrl.newTransaction)">C</div>
      </div>

      <ul class="account__editing-buttons">
        <li class="account__editing-button" ng-click="accountCtrl.saveCreateTransaction()">{{'SAVE' | translate}}</li><li class="account__editing-button account__editing-button--save" ng-click="accountCtrl.saveCreateTransaction(); accountCtrl.createTransaction()">{{'SAVE_AND_ADD_ANOTHER' | translate}}</li><li class="account__editing-button" ng-click="accountCtrl.cancelCreateTransaction()">{{'CANCEL' | translate}}</li>
      </ul>

    </div>
  </div>

  <virtual-list class="account__tbody account__tbody--striped"></virtual-list>

</div>

