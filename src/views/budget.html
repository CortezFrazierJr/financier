<div class="budget" flex-months>
  <table>
    <thead>
      <tr class="month-overview__row">
        <th class="budget__category-label"></th>
        <th class="month-overview__month-overview"
            colspan="3"
            ng-repeat="month in dbCtrl.months | limitFlexMonths : budgetCtrl.showMonths"
            ng-class="{'budget__month-end': !$last}">
          <div class="month-overview__month-text">{{month.data._id | date: 'MMMM yyyy'}}</div>
          <dl class="month-overview__month-list">
            <dt>
              <span ng-if="dbCtrl.months[$index - 1]">{{dbCtrl.months[$index - 1].cache.totalIncome - dbCtrl.months[$index - 1].cache.totalBudget | intCurrency | currency}}</span>
            </dt>
            <dd>Not budgeted in {{dbCtrl.months[$index - 1].data._id | date: 'MMM'}}</dd>
            <dt>{{overview.overspent}}</dt>
            <dd>Overspent in {{dbCtrl.months[$index - 1].data._id | date: 'MMM'}}</dd>
            <dt>{{overview.cache.totalIncome}}</dt>
            <dd>Income for {{month.data._id | date: 'MMM'}}</dd>
            <dt>{{month.cache.totalBudget | intCurrency | currency}}</dt>
            <dd>Budgeted in {{month.data._id | date: 'MMM'}}</dd>
          </dl>

          <div class="month-overview__month-total">= $20.00</div>
          <div class="month-overview__month-total-subtext">Available to budget</div>
        </th>
      </tr>
      <tr class="month-overview__row">
        <th class="budget__month-row budget__category-label"></th>
        <th class="budget__month-row month-overview__cell-head"
            ng-repeat-start="month in dbCtrl.months | limitFlexMonths : budgetCtrl.showMonths">Budgeted<div>{{month.cache.totalBudget | intCurrency | currency}}</div></th>
        <th class="budget__month-row month-overview__cell-head">Outflows<div>{{month.cache.totalTransactions | intCurrency | currency}}</div></th>
        <th class="budget__month-row month-overview__cell-head"
            ng-class="{'budget__month-end': !$last}"
            ng-repeat-end>Balance<div>{{month.cache.totalBalance | intCurrency | currency}}</div></th>
      </tr>
    </thead>
    <tbody class="overflowable">
      <tr class="month-body__row"
          ng-repeat="row in dbCtrl.categories"
          ng-init="catIndex = $index">
        <td class="budget__month-row budget__category-label">{{row.name}}</td>
        <td class="budget__month-row month-body__cell-head"
            ng-repeat-start="month in dbCtrl.months | limitFlexMonths : budgetCtrl.showMonths"
            >
          <input type="text"
                 class="budget__cell-input"
                 ng-attr-tabindex="{{(($index * dbCtrl.categories.length) + catIndex) + 1}}"
                 on-update="month.setBudget(row._id, model)"
                 view-model="month.data.categories[row._id].budget"></td>
        <td class="budget__month-row month-body__cell-head">0.00</td>
        <td class="budget__month-row month-body__cell-head"
            ng-class="{'budget__month-end': !$last}"
            ng-repeat-end>{{month.categoryCache[row._id].balance | intCurrency}}</td>
      </tr>
      
    </tbody>

    <tfoot>
            <tr>
        <td colspan="{{budgetCtrl.showMonths * 3 + 1}}">
          <div class="month-select">
            <div class="month-select__year-control">&lt;</div>
            <div class="month-select__year">2016</div>
            <div class="month-select__year-control">&gt;</div>
            <div class="month-select__month">Jan</div>
            <div class="month-select__month month-select__month--selected">Feb</div>
            <div class="month-select__month month-select__month--selected">Mar</div>
            <div class="month-select__month month-select__month--selected">Apr</div>
            <div class="month-select__month">May</div>
            <div class="month-select__month">Jun</div>
            <div class="month-select__month">Jul</div>
            <div class="month-select__month">Aug</div>
            <div class="month-select__month">Sep</div>
            <div class="month-select__month">Oct</div>
            <div class="month-select__month">Nov</div>
            <div class="month-select__month">Dec</div>
          </div>
        </td>
      </tr>
    </tfoot>

  </table>
</div>
